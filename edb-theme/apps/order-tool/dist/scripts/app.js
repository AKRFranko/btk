!function(e){"use strict";var t=e.querySelector("#app");t.baseUrl="/order-tool/",t.searchFilter="",t.catalogOpened=!1,t.lastOrderResponse,t.addEventListener("dom-change",function(){console.log("Our app is ready to rock!")}),window.addEventListener("WebComponentsReady",function(){EDB.load(t.onEDBLoaded,t.notifyProgress)}),t.echo=function(e,t){return e},t.handlePrepareForNewOrder=function(){window.location.reload(!0)};var r=function(){var e=t.$.listCatalog.items;t.$.listCatalog.items=[],t.async(function(){t.$.listCatalog.items=e}),t.$.listCatalog.render()};t.hideErrors=function(){var t=e.querySelector("#errorToast");t.close()},t.displayErrors=function(t){var r=e.querySelector("#errorToast");r.text=t.join("\n"),r.open()},t.onEDBLoaded=function(){t.customFee={title:null,taxable:!0,total:null},t.shippingChanged=null,t.searchInput="",t.set("products",EDB.products),t.cartItems=[],t.feeItems=[],t.shippingAddress=EDB.shippingAddress,t.billingAddress=EDB.billingAddress,t.edbLoaded=!0;var r;e.querySelector("#searchFilter").addEventListener("input",function(){clearTimeout(r),r=setTimeout(function(){t.searchInput&&""!=t.searchInput.trim()?t.set("searchFilter",t.searchInput.trim()):t.set("searchFilter","")},10)})},t.filterProducts=function(e){return e&&(e=e.trim()),function(t){return e?t?~t.raw.categories.indexOf(e):!1:!0}},t.sortProducts=function(e){return e?function(t,r){if(!e)return 1;var n=LiquidMetal.score(t.name,e),o=LiquidMetal.score(r.name,e);return o>n?1:-1}:function(){return-1}},t.computeTotals=function(){return EDB.calculateTotals().filter(function(e){return"total"===e.label?!0:0!==e.value})},t.computeZone=function(e){return EDB.getZone(e)},t.handleOpenCatalog=function(){e.querySelector("#catalog").open()},t.handleOpenFees=function(){e.querySelector("#addFee").open()},t.handleAddToCart=function(e){var n=Polymer.dom(e).rootTarget,o=n.parentElement,s=o.querySelector("iron-selector"),i=o.querySelector(".variation-quantity"),a=(s.querySelector("template"),e.model.product),d=a.variations.reduce(function(e,t){return t.id==a.selectedVariation?t:e},null),l=a.wantedQuantity;i.value=null,s.selected=null,EDB.addToCart(a,d,l),EDB.cartItems.forEach(function(e,r){var n=t.get("cartItems."+r);!n||n&&n.token!==e.token?t.push("cartItems",e):t.set("cartItems."+r,e)}),e.model.set("product.selectedVariation",a.variations[0].id),e.model.set("product.wantedQuantity",null),r()},t.handleRemoveFromCart=function(e){var n=EDB.removeCartItem(e.model.cartItem.token);t.splice("cartItems",n,1),r()},t.handleAddFee=function(){EDB.addFee(t.customFee),t.customFee={title:null,taxable:!0,total:null},EDB.feeItems.forEach(function(e,r){var n=t.get("feeItems."+r);!n||n&&n.token!==e.token?t.push("feeItems",e):t.set("feeItems."+r,e)}),e.querySelector("#listOfFees").render()},t.handleShippingChanged=function(){t.set("shippingChanged",Date.now().toString(36))},t.handleRemoveFee=function(r){var n=EDB.removeFee(r.model.feeItem.token);t.splice("feeItems",n,1),e.querySelector("#listOfFees").render()},t.toMoney=function(e){return"$ "+(1*e).toFixed(2)},t.handlePostOrder=function(){t.hideErrors();var e=[];if(EDB.orderRequiresShipping()&&(EDB.shippingAddress.postcode||e.push("Missing postal code."),EDB.shippingAddress.address_1||e.push("Missing street address."),EDB.shippingAddress.city||e.push("Missing city."),EDB.shippingAddress.state||e.push("Missing province.")),EDB.billingAddress.email||e.push("Missing customer email."),0==EDB.cartItems.length&&0==EDB.feeItems.length&&e.push("Nothing to bill."),e.length>0)return t.displayErrors(e);var r=EDB.postOrder();r.fail(function(e){return t.displayErrors([e])}),r.done(function(e){t.lastOrderResponse=e,t.route="complete"})},t.computePayOrderUrl=function(e){return e?"https://elementdebase.com/checkout/order-pay/"+e.order.id+"/?pay_for_order=true&key="+e.order.order_key:"#"},t.handleSendOrderEmail=function(){var e=lastOrderResponse.order.id,t=lastOrderResponse.order.order_key;EDB.sendOrderEmail(e,t)},t.scrollPageToTop=function(){},t.closeDrawer=function(){}}(document);